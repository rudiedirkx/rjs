(function(a,b){"use strict";function h(a,b){return void 0!==a?a:b}function i(a){return"number"==typeof a.length&&"string"!=typeof a&&a.constructor!=Object}function j(a){var b=a+"";try{return b.match(/ (.+?)[\(\]]/)[1]}catch(c){return j(a.constructor)}}function k(a,b,c){if(i(a))for(var d=0,e=a.length;e>d;d++)b.call(c,a[d],d,a);else for(var f in a)a.hasOwnProperty(f)&&b.call(c,a[f],f,a);return a}function l(a,b){a instanceof Array||(a=[a]),k(a,function(a){var c=a.prototype?a.prototype:a;k(b,function(b,d){c[d]=b,a==Element&&(t.prototype[d]=function(){var a=arguments;return this.invoke(d,a,!1)})})})}function m(a,b,c){Object.defineProperty?Object.defineProperty(a.prototype,b,{get:c}):a.prototype.__defineGetter__(b,c)}function t(a){var b=this;k(a,function(a){1===a.nodeType&&b.push(a)})}function u(a,b){this.x=a,this.y=b}function v(b){"string"==typeof b?(this.originalEvent=null,b={type:b,target:null}):this.originalEvent=b,this.type=b.type,this.target=b.target||b.srcElement,this.relatedTarget=b.relatedTarget,this.fromElement=b.fromElement,this.toElement=b.toElement,this.key=b.keyCode||b.which,this.alt=b.altKey,this.ctrl=b.ctrlKey,this.shift=b.shiftKey,this.button=b.button||b.which,this.leftClick=1==this.button,this.rightClick=2==this.button,this.middleClick=4==this.button||1==this.button&&2==this.key,this.leftClick=this.leftClick&&!this.middleClick,this.which=this.key||this.button,this.detail=b.detail,null!=b.pageX&&null!=b.pageY?this.pageXY=new u(b.pageX,b.pageY):null!=b.clientX&&null!=b.clientY&&(this.pageXY=new u(b.clientX,b.clientY).add(a.getScroll())),this.data=b.clipboardData,this.time=b.timeStamp||b.timestamp||b.time||Date.now(),this.total=b.total||b.totalSize,this.loaded=b.loaded||b.position}function w(a){this.subject=a,this.time=Date.now()}function x(){var a=b.readyState;f||"complete"!=a&&"interactive"!=a||(f=!0,b.fire("ready"))}function y(){e=!0,b.addEventListener?b.addEventListener("DOMContentLoaded",x,!1):b.attachEvent&&b.attachEvent("onreadystatechange",x)}function z(a,c){return"function"==typeof a?f?(setTimeout(a,1),b):b.on("ready",a):c?b.getElement(a):b.getElementById(a)}function A(a){return i(a)?new t(a):b.getElements(a)}function B(a,b){b||(b={});var c=new XMLHttpRequest,d=h(b.method,"GET").toUpperCase(),e=h(b.async,!0),f=h(b.send,!0),g=b.data||"";if(c.open(d,a,e,b.username,b.password),c.url=a,c.method=d,c.on("readystatechange",function(a){if(4==this.readyState){var b=200==this.status,c=b?"success":"error";this.fire(c,a),this.fire("done",a),this.globalFire("xhr",c,a),this.globalFire("xhr","done",a)}}),"POST"==d&&(!g.constructor||g.constructor!=window.FormData)){var i=b.encoding?"; charset="+i:"";c.setRequestHeader("Content-type","application/x-www-form-urlencoded"+i)}return f&&(c.globalFire("xhr","start"),c.fire("start"),c.send(g)),c}function C(a){return function(b,c,d){d||(d={}),d.method=a,d.data=c;var e=B(b,d);return e}}var c=b.documentElement,d=c.getElementsByTagName("head")[0];a.html=c,a.head=d;var e=!1,f=!1,g={};l(Array,{contains:function(a){return-1!=this.indexOf(a)},unique:function(){var a=[];return k(this,function(b){a.contains(b)||a.push(b)}),a},each:function(a,b){return k(this,a,b)},first:function(){return this[0]||null},last:function(){return this[this.length-1]||null}}),Array.defaultFilterCallback=function(a){return!!a},l(String,{camel:function(){return this.replace(/\-([^\-])/g,function(a,b){return b.toUpperCase()})},uncamel:function(){return this.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()})}});var n=[].indexOf,p=([].slice,[].push),q=[].splice,r=[].join;[].join,"function"==typeof Date.now||(Date.now=function(){return+new Date}),"classList"in c||function(){function b(a){this._el=a,a.$classList=this,this._reinit()}l(b,{_reinit:function(){this.length=0;var a=this._el.className.trim();a=a?a.split(/\s+/g):[];for(var b=0,c=a.length;c>b;b++)p.call(this,a[b]);return this},set:function(){this._el.className=r.call(this," ")},add:function(a){p.call(this,a),this.set()},contains:function(a){return-1!==n.call(this,a)},item:function(a){return this[a]||null},remove:function(a){var b=n.call(this,a);-1!=b&&(q.call(this,b,1),this.set())},toggle:function(a){this.contains(a)?this.remove(a):this.add(a)}}),a.DOMTokenList=b,m(Element,"classList",function(){return this.$classList?this.$classList._reinit():new b(this)})}(),l(DOMTokenList,{replace:function(a,b){this.remove(a),this.add(b)}}),t.prototype=Array.prototype,l(t,{invoke:function(a,b,c){var d=[];return k(this,function(c){d.push(c[a].apply(c,b))}),c?this:d}}),l(u,{add:function(a){return new u(this.x+a.x,this.y+a.y)},subtract:function(a){return new u(this.x-a.x,this.y-a.y)},toCSS:function(){return{left:this.x+"px",top:this.y+"px"}}}),l(v,{summary:function(){var a=[];return k(this,function(b,c){b&&"object"==typeof b&&(b=j(b)),a.push(c+" => "+b)}),a.join("\n")},preventDefault:function(){var a=this.originalEvent;a.preventDefault&&a.preventDefault(),a.returnValue=!1},stopPropagation:function(){var a=this.originalEvent;a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},setSubject:function(a){this.subject=a,this.pageXY&&(this.subjectXY=this.pageXY,this.subject.getPosition&&(this.subjectXY=this.subjectXY.subtract(this.subject.getPosition())))}}),Event.Keys={enter:13,up:38,down:40,left:37,right:39,esc:27,space:32,backspace:8,tab:9,"delete":46},Event.Custom={mouseenter:{type:"mouseover",filter:function(a){return a.fromElement!=this&&!this.contains(a.fromElement)}},mouseleave:{type:"mouseout",filter:function(a){return a.toElement!=this&&!this.contains(a.toElement)}},mousewheel:{type:"onmousewheel"in a?"mousewheel":"mousescroll"},directchange:{type:"keyup",filter:function(){var b=null==this.__lastDCValue?this.defaultValue:this.__lastDCValue,c=this.value;return this.__lastDCValue=c,null==b||b!=c}}},"onmouseenter"in c&&delete Event.Custom.mouseenter,"onmouseleave"in c&&delete Event.Custom.mouseleave,k([window,document,Element,t],function(a){a.extend=function(a){l([this],a)}}),l(w,{$cache:function(a,b,c){return this.$$cache||(this.$$cache={}),this.$$cache[a]||(this.$$cache[a]=c||{}),null!=b&&(this.$$cache[a]=b),this.$$cache[a]},_addEventListener:function(a,b){return this.addEventListener&&this.addEventListener(a,b),this},_removeEventListener:function(a,b){return this.removeEventListener&&this.removeEventListener(a,b),this},on:function(a,b,c){function f(a){a&&!(a instanceof v)&&(a=new v(a));var d=this;if(!(a&&a.target&&b&&!(d=a.target.selfOrFirstAncestor(b))||e&&e.filter&&!e.filter.call(d,a)))return a.subject||a.setSubject(d),c.call(d,a)}c||(c=b)&&(b=null);var d=a,e=!1;if(Event.Custom[a]&&(e=Event.Custom[a],e.type&&(d=e.type)),!e||!e.before||e.before.call(this)!==!1){var g=this.$cache("events");return g[a]||(g[a]=[]),g[a].push({type:d,original:c,callback:f}),this._addEventListener(d,f)}},fire:function(a,b){var c=this.$cache("events");return c[a]&&(b||(b=new v(a)),k(c[a],function(a){a.callback.call(this,b)},this)),this},off:function(a,b){var c=this.$cache("events");if(c[a]){var d=!1;k(c[a],function(e,f){b&&b!=e.original||(d=!0,delete c[a][f],this._removeEventListener(e.type,e.callback))},this),d&&(c[a]=c[a].filter(Array.defaultFilterCallback))}return this},globalFire:function(b,c,d){var e=d?d:new v(c),f=(b+"-"+c).camel();return e.target=e.subject=this,e.type=c,e.globalType=b,a.fire(f,e),this}}),l([a,b,Element,XMLHttpRequest],w.prototype),a.XMLHttpRequestUpload&&l([XMLHttpRequestUpload],w.prototype),l([Element,Text],{firstAncestor:function(a){for(var c=this;(c=c.parentNode)&&c!=b;)if(c.is(a))return c},getNext:function(){if(void 0!==this.nextElementSibling)return this.nextElementSibling;for(var a=this;(a=a.nextSibling)&&1!=a.nodeType;);return a},getPrev:function(){if(void 0!==this.previousElementSibling)return this.previousElementSibling;for(var a=this;(a=a.previousSibling)&&1!=a.nodeType;);return a},remove:Element.prototype.remove||function(){return this.parentNode.removeChild(this)},getParent:function(){return this.parentNode},insertAfter:function(a,b){var c=b.nextSibling;return c?this.insertBefore(a,c):this.appendChild(a)}}),l(document,{el:function(a,b){var c=this.createElement(a);return b&&c.attr(b),c}}),Element.attr2method={html:function(a){return null==a?this.getHTML():this.setHTML(a)},text:function(a){return null==a?this.getText():this.setText(a)}},l(Element,{is:Element.prototype.matches||Element.prototype.webkitMatches||Element.prototype.mozMatches||Element.prototype.msMatches||Element.prototype.oMatches||Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||function(a){return A(a).contains(this)},selfOrFirstAncestor:function(a){return this.is(a)?this:this.firstAncestor(a)},contains:Element.prototype.contains||function(a){return this.getElements("*").contains(a)},getChildren:function(){return new t(this.children||this.childNodes)},getFirst:function(){return void 0!==this.firstElementChild?this.firstElementChild:this.getChildren().first()},getLast:function(){return void 0!==this.lastElementChild?this.lastElementChild:this.getChildren().last()},attr:function(a,b,c){if(null==c&&(c=""),void 0===b){if("string"==typeof a)return Element.attr2method[c+a]?Element.attr2method[c+a].call(this,b,c):this.getAttribute(c+a);var d=this;k(a,function(a,b){if(null===a)d.removeAttribute(c+b);else{if(Element.attr2method[c+b])return Element.attr2method[c+b].call(d,a,c);d.setAttribute(c+b,a)}})}else if(null===b)this.removeAttribute(c+a);else{if("function"==typeof b&&(b=b.call(this,this.getAttribute(c+a))),Element.attr2method[c+a])return Element.attr2method[c+a].call(this,b,c);this.setAttribute(c+a,b)}return this},data:function(a,b){return this.attr(a,b,"data-")},getHTML:function(){return this.innerHTML},setHTML:function(a){return this.innerHTML=a,this},getText:function(){return this.innerText||this.textContent},setText:function(a){return this.textContent=this.innerText=a,this},getElement:function(a){return this.querySelector(a)},getElements:function(a){return A(this.querySelectorAll(a))},removeClass:function(a){return this.classList.remove(a),this},addClass:function(a){return this.classList.add(a),this},toggleClass:function(a){return this.classList.toggle(a),this},replaceClass:function(a,b){return this.classList.replace(a,b),this},injectBefore:function(a){return a.parentNode.insertBefore(this,a),this},injectAfter:function(a){return a.parentNode.insertAfter(this,a),this},inject:function(a){return a.appendChild(this),this},append:function(a){return this.appendChild(a),this},hover:function(a,b,c){return a||(c=b)&&(b=a)&&(a=null),this.on("mouseenter",b).on("mouseleave",c)},getStyle:function(a){return getComputedStyle(this).getPropertyValue(a)},css:function(a,b){return void 0===b?"string"==typeof a?this.getStyle(a):(k(a,function(a,b){this.style[b]=a},this),this):(this.style[a]=b,this)},show:function(){if(!g[this.nodeName]){var a=document.el(this.nodeName).inject(this.ownerDocument.body);g[this.nodeName]=a.getStyle("display"),a.remove()}return this.css("display",g[this.nodeName])},hide:function(){return this.css("display","none")},toggle:function(){return"none"==this.getStyle("display")?this.show():this.hide()},empty:function(){try{this.innerHTML=""}catch(a){for(;this.firstChild;)this.removeChild(this.firstChild)}return this},getPosition:function(){var b=this.getBoundingClientRect();return new u(b.left,b.top).add(a.getScroll())},getScroll:function(){return new u(this.scrollLeft,this.scrollTop)}}),l(document,{getElement:Element.prototype.getElement,getElements:Element.prototype.getElements}),l([a,b],{getScroll:function(){return new u(document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop)}}),Event.Custom.ready={before:function(){this==document&&(e||y())}},a.$ifsetor=h,a.$class=j,a.$=z,a.$$=A,a.$each=k,a.$extend=l,a.Elements=t,a.AnyEvent=v,a.Eventable=w,a.Coords2D=u,a.$.xhr=B,a.$.get=C("get"),a.$.post=C("post")})(this,this.document);